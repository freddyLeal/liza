angular.module('app.controllers', [])

    .controller('siteController',function($scope, $ionicModal, $timeout, $http) {
        $scope.urlBase = "http://localhost/sword/";


        ////////////////// LOGIN ///////////////////////
        $scope.loginData = {};
        $scope.loginMessage = "";

        $ionicModal.fromTemplateUrl('views/site/login.html', {
            scope: $scope
        }).then(function(modal) {
            $scope.modal = modal;
        });

        $scope.closeLogin = function() {
            $scope.modal.hide();
        };

        $scope.login = function() {
            $scope.modal.show();
        };

        $scope.doLogin = function() {
            $http.post($scope.urlBase+"site/login",  $scope.loginData   ).then(
                function(response){ 
                    if( response.data.sistemConfirm == true){
                        $scope.closeLogin();
                    } else {
                        $scope.loginMessage = response.data.sistemMessage;
                    }
                },
                function(response){ console.log("Unexpected error."); }
            );            

            // console.log('Doing login', $scope.loginData);
            // $timeout(function() {
            //     $scope.closeLogin();
            // }, 1000);
        };
        ////////////////////// END LOGIN ////////////

    });